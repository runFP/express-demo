<!DOCTYPE html><html><head><title>05-25</title><style>html, body {
    margin: 0;
    padding: 0;
}

.container {
    position: relative;
    height: 100%;
    display: flex;
    flex-wrap: wrap;
    box-sizing: border-box;
}

.cell {
    position: absolute;
    box-sizing: border-box;
}

iframe {
    border: none;
}</style></head><body><div class="cell" style="top: 0%;width: 33.333333333333336%;left: 0%;height: 33.333333333333336%;"></div><div class="cell" style="top: 0%;width: 33.333333333333336%;left: 33.333333333333336%;height: 33.333333333333336%;"><iframe width="100%" height="100%" src="http://localhost:4200/#/widgets/AnalysisComponent/abc" scrolling="no"></iframe></div><div class="cell" style="top: 0%;width: 33.333333333333336%;left: 66.66666666666667%;height: 33.333333333333336%;"></div><div class="cell" style="top: 33.333333333333336%;width: 33.333333333333336%;left: 0%;height: 33.333333333333336%;"><iframe width="100%" height="100%" src="http://localhost:4200/#/widgets/AnalysisComponent/abc" scrolling="no"></iframe></div><div class="cell" style="top: 33.333333333333336%;width: 33.333333333333336%;left: 33.333333333333336%;height: 33.333333333333336%;"><iframe width="100%" height="100%" src="http://localhost:4200/#/widgets/AnalysisComponent/abc" scrolling="no"></iframe></div><div class="cell" style="top: 33.333333333333336%;width: 33.333333333333336%;left: 66.66666666666667%;height: 33.333333333333336%;"><iframe width="100%" height="100%" src="http://localhost:4200/#/widgets/AnalysisComponent/abc" scrolling="no"></iframe></div><div class="cell" style="top: 66.66666666666667%;width: 33.333333333333336%;left: 0%;height: 33.333333333333336%;"></div><div class="cell" style="top: 66.66666666666667%;width: 33.333333333333336%;left: 33.333333333333336%;height: 33.333333333333336%;"><iframe width="100%" height="100%" src="http://localhost:4200/#/widgets/AnalysisComponent/abc" scrolling="no"></iframe></div><div class="cell" style="top: 66.66666666666667%;width: 33.333333333333336%;left: 66.66666666666667%;height: 33.333333333333336%;"></div><script>var adminToken = '';
function getQueryParams() {
    var params = location.search.replace(/^\?/, '').split('&');
    var data = {};
    params.forEach(function (p) {
        var value = p.split('=');
        data[value[0]] = value[1];
    })
    return data;
}
var tokenId = getQueryParams().tokenId;

function postMessage(token) {
    var ifrs = document.getElementsByTagName('iframe');
    [].slice.apply(ifrs).forEach(function (ifr, index) {
        ifr.onload = function () {
            ifr.contentWindow.postMessage({
                token: token,
                id: index,
            }, ifr.src.split('/#')[0]);
        }
    })
}

if (tokenId) {
    fetch('http://10.16.40.172:8002/afs/serverbasedigital/boardtokenservice/GetToken', {
        body: new URLSearchParams('tokenId=' + tokenId),
        method: 'POST',
        mode: 'cors',
    })
        .then(function (response) {
            if (response.ok) {
                return response.json();
            }
        })
        .then(function (res) {
            if (res.Success) {
                debugger
                postMessage(res.Extra.TOKEN)
            } else {
                console.log(res.Message);
            }
        })
        .catch(function (error) {
            console.log('There has been a problem with your fetch operation: ', error.message);
        })
} else {
    if (adminToken) {
        postMessage(adminToken);
    } else {
        console.warn('must need tokenId to get token from serve!');
    }
}</script></body></html>